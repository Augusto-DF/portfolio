name: Staging portfolio deployment

on:
  push:
    branches: [staging]
  pull_request:
    branches: [staging]

  workflow_dispatch:

jobs:
  build:
    runs-on: ubuntu-latest
    steps:
      - name: Build
        run: |
          ls -a
          # git pull origin staging
          # rm -r build/
          # yarn build

  deploy-staging:
    runs-on: ubuntu-latest
    environment:
      name: staging
    needs: [build]
    steps:
      - name: Repo Checkout
        uses: actions/checkout@v4

      - name: VPS Deployment
        uses: easingthemes/ssh-deploy@main
        with:
          SSH_PRIVATE_KEY: |
            -----BEGIN OPENSSH PRIVATE KEY-----
            b3BlbnNzaC1rZXktdjEAAAAACmFlczI1Ni1jdHIAAAAGYmNyeXB0AAAAGAAAABAn84WzaM
            T3e2Cnrz/nAjkoAAAAGAAAAAEAAAAzAAAAC3NzaC1lZDI1NTE5AAAAIPHiMzR3sFanRS0G
            I6XkYJaYzeuLxp4QZjtChKzlLjYtAAAAoBYbdbLjKZ0Tz7E946oD5ed/abYpetRWOuZIdQ
            GvNJuOb+z6hH5Qk6XT+XWhmYjx4f7VEuvnNxu4V5hilREXIBbjAEey9ShjnOhsaUGrISuK
            0CuLxScy/zrj5CjBO5nY6jA/bFeDVlaw7qGHmDlmAwy+pYXUKAgR1C664M6rtg/30cZAR6
            6kJ8FEcBdMlbpHpPqr/8Di6xrPNBFW5heNczI=
            -----END OPENSSH PRIVATE KEY-----

          ARGS: '-rlgoDzvc -i --delete'
          SOURCE: 'build/'
          REMOTE_HOST: '195.200.7.134'
          REMOTE_USER: 'root'
          REMOTE_PORT: 22
          TARGET: '~/../home/projects/augustocode/staging/portfolio/'
